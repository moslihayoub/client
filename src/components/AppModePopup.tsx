import React, { useState } from 'react';
import TrSun from '../svgs/transparent/TrSun';
import TrMoon from '../svgs/transparent/TrMoon';
import TrSystem from '../svgs/transparent/TrSystem';
import GrMoon from '../svgs/gray/GrMoon';
import GrSun from '../svgs/gray/GrSun';
import ColSun from '../svgs/colored/ColSun';
import ColMoon from '../svgs/colored/ColMoon';
import ColSystem from '../svgs/colored/ColSystem';

interface AppModePopupProps {
  isOpen: boolean;
  onClose: () => void;
  onAppModeChange: (appMode: string) => void;
  currentAppMode: string;
}

const SunCol: React.ComponentType = () => {
  return (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" className='group-hover:block hidden'>
      <path d="M17 12C17 13.3261 16.4732 14.5979 15.5355 15.5355C14.5979 16.4732 13.3261 17 12 17C10.6739 17 9.40215 16.4732 8.46447 15.5355C7.52678 14.5979 7 13.3261 7 12C7 10.6739 7.52678 9.40215 8.46447 8.46447C9.40215 7.52678 10.6739 7 12 7C13.3261 7 14.5979 7.52678 15.5355 8.46447C16.4732 9.40215 17 10.6739 17 12Z" fill="url(#paint0_radial_2449_3622)" />
      <path fill-rule="evenodd" clip-rule="evenodd" d="M12 1.25C12.1989 1.25 12.3897 1.32902 12.5303 1.46967C12.671 1.61032 12.75 1.80109 12.75 2V4C12.75 4.19891 12.671 4.38968 12.5303 4.53033C12.3897 4.67098 12.1989 4.75 12 4.75C11.8011 4.75 11.6103 4.67098 11.4697 4.53033C11.329 4.38968 11.25 4.19891 11.25 4V2C11.25 1.80109 11.329 1.61032 11.4697 1.46967C11.6103 1.32902 11.8011 1.25 12 1.25ZM1.25 12C1.25 11.8011 1.32902 11.6103 1.46967 11.4697C1.61032 11.329 1.80109 11.25 2 11.25H4C4.19891 11.25 4.38968 11.329 4.53033 11.4697C4.67098 11.6103 4.75 11.8011 4.75 12C4.75 12.1989 4.67098 12.3897 4.53033 12.5303C4.38968 12.671 4.19891 12.75 4 12.75H2C1.80109 12.75 1.61032 12.671 1.46967 12.5303C1.32902 12.3897 1.25 12.1989 1.25 12ZM19.25 12C19.25 11.8011 19.329 11.6103 19.4697 11.4697C19.6103 11.329 19.8011 11.25 20 11.25H22C22.1989 11.25 22.3897 11.329 22.5303 11.4697C22.671 11.6103 22.75 11.8011 22.75 12C22.75 12.1989 22.671 12.3897 22.5303 12.5303C22.3897 12.671 22.1989 12.75 22 12.75H20C19.8011 12.75 19.6103 12.671 19.4697 12.5303C19.329 12.3897 19.25 12.1989 19.25 12ZM12 19.25C12.1989 19.25 12.3897 19.329 12.5303 19.4697C12.671 19.6103 12.75 19.8011 12.75 20V22C12.75 22.1989 12.671 22.3897 12.5303 22.5303C12.3897 22.671 12.1989 22.75 12 22.75C11.8011 22.75 11.6103 22.671 11.4697 22.5303C11.329 22.3897 11.25 22.1989 11.25 22V20C11.25 19.8011 11.329 19.6103 11.4697 19.4697C11.6103 19.329 11.8011 19.25 12 19.25Z" fill="url(#paint1_radial_2449_3622)" />
      <path opacity="0.5" d="M3.67008 3.71611C3.80421 3.5694 3.99108 3.48195 4.18965 3.47295C4.38822 3.46395 4.58224 3.53414 4.72908 3.66811L6.95008 5.70011C7.0938 5.83508 7.17859 6.02123 7.18609 6.21825C7.1936 6.41527 7.12322 6.60732 6.99019 6.75285C6.85715 6.89837 6.67217 6.98565 6.47527 6.9958C6.27836 7.00596 6.08538 6.93817 5.93808 6.80711L3.71708 4.77511C3.64429 4.70868 3.58531 4.62856 3.5435 4.53932C3.50169 4.45009 3.47788 4.35349 3.47342 4.25505C3.46897 4.15661 3.48395 4.05826 3.51752 3.96561C3.5511 3.87296 3.6026 3.78784 3.66908 3.71511M20.3321 3.71611C20.3986 3.78878 20.4502 3.87385 20.4839 3.96646C20.5175 4.05907 20.5326 4.1574 20.5282 4.25584C20.5239 4.35428 20.5001 4.4509 20.4584 4.54017C20.4167 4.62944 20.3578 4.70961 20.2851 4.77611L18.0621 6.80611C17.9902 6.87654 17.9049 6.93179 17.8112 6.96855C17.7175 7.00532 17.6173 7.02285 17.5167 7.0201C17.4161 7.01736 17.3171 6.99439 17.2256 6.95257C17.134 6.91075 17.0518 6.85093 16.9839 6.77668C16.9159 6.70242 16.8636 6.61526 16.8301 6.52037C16.7965 6.42548 16.7824 6.3248 16.7886 6.22435C16.7948 6.12389 16.8211 6.02571 16.866 5.93564C16.911 5.84558 16.9736 5.76547 17.0501 5.70011L19.2721 3.66811C19.3448 3.60162 19.4299 3.55012 19.5226 3.51655C19.6152 3.48298 19.7136 3.46799 19.812 3.47245C19.9105 3.47691 20.0071 3.50072 20.0963 3.54253C20.1855 3.58433 20.2657 3.64332 20.3321 3.71611ZM17.0261 17.0251C17.1667 16.8847 17.3573 16.8058 17.5561 16.8058C17.7548 16.8058 17.9455 16.8847 18.0861 17.0251L20.3091 19.2471C20.3807 19.3163 20.4378 19.3991 20.477 19.4906C20.5163 19.5822 20.5369 19.6806 20.5378 19.7802C20.5386 19.8797 20.5196 19.9785 20.4818 20.0707C20.4441 20.1628 20.3883 20.2465 20.3179 20.3169C20.2474 20.3873 20.1637 20.4429 20.0715 20.4806C19.9793 20.5183 19.8805 20.5372 19.7809 20.5363C19.6813 20.5354 19.5829 20.5146 19.4914 20.4753C19.4 20.4359 19.3172 20.3788 19.2481 20.3071L17.0261 18.0851C16.8856 17.9445 16.8067 17.7539 16.8067 17.5551C16.8067 17.3564 16.8856 17.1657 17.0261 17.0251ZM6.97508 17.0251C7.11553 17.1657 7.19442 17.3564 7.19442 17.5551C7.19442 17.7539 7.11553 17.9445 6.97508 18.0851L4.75308 20.3081C4.61091 20.4406 4.42286 20.5127 4.22856 20.5093C4.03426 20.5059 3.84887 20.4271 3.71146 20.2897C3.57405 20.1523 3.49534 19.9669 3.49191 19.7726C3.48848 19.5783 3.5606 19.3903 3.69308 19.2481L5.91508 17.0251C6.05571 16.8847 6.24633 16.8058 6.44508 16.8058C6.64383 16.8058 6.83446 16.8847 6.97508 17.0251Z" fill="url(#paint2_radial_2449_3622)" />
      <defs>
        <radialGradient id="paint0_radial_2449_3622" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(12 6.22626) rotate(90) scale(14.1561)">
          <stop stop-color="#2DD4BF" />
          <stop offset="0.509615" stop-color="#0EA5E9" />
          <stop offset="1" stop-color="#D946EF" />
        </radialGradient>
        <radialGradient id="paint1_radial_2449_3622" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(12 -0.413542) rotate(90) scale(30.4356)">
          <stop stop-color="#2DD4BF" />
          <stop offset="0.509615" stop-color="#0EA5E9" />
          <stop offset="1" stop-color="#D946EF" />
        </radialGradient>
        <radialGradient id="paint2_radial_2449_3622" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(12.0052 2.15132) rotate(90) scale(24.1569 24.1576)">
          <stop stop-color="#2DD4BF" />
          <stop offset="0.509615" stop-color="#0EA5E9" />
          <stop offset="1" stop-color="#D946EF" />
        </radialGradient>
      </defs>
    </svg>
  )
}

const MoonCol: React.ComponentType = () => {
  return (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" className='group-hover:block hidden'>
      <path d="M2 11.9996C2 6.47656 6.477 1.99956 12 1.99956C12.463 1.99956 12.54 2.69256 12.143 2.93256C11.2987 3.44231 10.5814 4.13753 10.0455 4.96554C9.50967 5.79356 9.16926 6.73266 9.0501 7.71172C8.93093 8.69078 9.03613 9.68412 9.35772 10.6165C9.67932 11.5489 10.2089 12.3959 10.9063 13.0933C11.6037 13.7907 12.4507 14.3202 13.383 14.6418C14.3154 14.9634 15.3088 15.0686 16.2878 14.9495C17.2669 14.8303 18.206 14.4899 19.034 13.954C19.862 13.4182 20.5572 12.7009 21.067 11.8566C21.307 11.4606 22 11.5366 22 11.9996C22 13.1376 21.81 14.2306 21.46 15.2496H22C22.1989 15.2496 22.3897 15.3286 22.5303 15.4692C22.671 15.6099 22.75 15.8006 22.75 15.9996C22.75 16.1985 22.671 16.3892 22.5303 16.5299C22.3897 16.6705 22.1989 16.7496 22 16.7496H2C1.80109 16.7496 1.61032 16.6705 1.46967 16.5299C1.32902 16.3892 1.25 16.1985 1.25 15.9996C1.25 15.8006 1.32902 15.6099 1.46967 15.4692C1.61032 15.3286 1.80109 15.2496 2 15.2496H2.54C2.18156 14.2035 1.99908 13.1053 2 11.9996ZM5 18.2496C4.80109 18.2496 4.61032 18.3286 4.46967 18.4692C4.32902 18.6099 4.25 18.8006 4.25 18.9996C4.25 19.1985 4.32902 19.3892 4.46967 19.5299C4.61032 19.6705 4.80109 19.7496 5 19.7496H19C19.1989 19.7496 19.3897 19.6705 19.5303 19.5299C19.671 19.3892 19.75 19.1985 19.75 18.9996C19.75 18.8006 19.671 18.6099 19.5303 18.4692C19.3897 18.3286 19.1989 18.2496 19 18.2496H5ZM8 21.2496C7.80109 21.2496 7.61032 21.3286 7.46967 21.4692C7.32902 21.6099 7.25 21.8006 7.25 21.9996C7.25 22.1985 7.32902 22.3892 7.46967 22.5299C7.61032 22.6705 7.80109 22.7496 8 22.7496H16C16.1989 22.7496 16.3897 22.6705 16.5303 22.5299C16.671 22.3892 16.75 22.1985 16.75 21.9996C16.75 21.8006 16.671 21.6099 16.5303 21.4692C16.3897 21.3286 16.1989 21.2496 16 21.2496H8ZM19.9 2.30656C19.8647 2.21595 19.8028 2.13812 19.7225 2.08325C19.6422 2.02838 19.5472 1.99902 19.45 1.99902C19.3528 1.99902 19.2578 2.02838 19.1775 2.08325C19.0972 2.13812 19.0353 2.21595 19 2.30656L18.57 3.40156C18.5461 3.46357 18.5096 3.51994 18.4628 3.56711C18.4159 3.61427 18.3598 3.6512 18.298 3.67556L17.207 4.10756C17.1167 4.14354 17.0392 4.20581 16.9846 4.2863C16.93 4.36679 16.9008 4.4618 16.9008 4.55906C16.9008 4.65631 16.93 4.75132 16.9846 4.83181C17.0392 4.9123 17.1167 4.97457 17.207 5.01056L18.298 5.44256C18.3597 5.4668 18.4158 5.50357 18.4626 5.55056C18.5094 5.59755 18.546 5.65373 18.57 5.71556L19 6.80956C19.162 7.21956 19.74 7.21956 19.9 6.80956L20.33 5.71456C20.3541 5.65263 20.3908 5.59639 20.4378 5.5494C20.4848 5.5024 20.5411 5.46568 20.603 5.44156L21.694 5.00956C21.7843 4.97357 21.8618 4.9113 21.9164 4.83081C21.971 4.75032 22.0002 4.65531 22.0002 4.55806C22.0002 4.4608 21.971 4.36579 21.9164 4.2853C21.8618 4.20481 21.7843 4.14254 21.694 4.10656L20.603 3.67456C20.541 3.65032 20.4847 3.61344 20.4377 3.56627C20.3907 3.5191 20.354 3.46266 20.33 3.40056L19.9 2.30656Z" fill="url(#paint0_radial_2449_3616)" />
      <path d="M16.0332 8.1298C15.9978 8.03919 15.936 7.96136 15.8557 7.90649C15.7754 7.85162 15.6804 7.82227 15.5832 7.82227C15.4859 7.82227 15.3909 7.85162 15.3106 7.90649C15.2303 7.96136 15.1685 8.03919 15.1332 8.1298L14.9762 8.5288C14.9521 8.59063 14.9156 8.64681 14.8688 8.69379C14.8219 8.74078 14.7659 8.77756 14.7042 8.8018L14.3062 8.9598C14.2158 8.99579 14.1383 9.05805 14.0838 9.13854C14.0292 9.21903 14 9.31405 14 9.4113C14 9.50855 14.0292 9.60356 14.0838 9.68405C14.1383 9.76455 14.2158 9.82681 14.3062 9.8628L14.7042 10.0198C14.8292 10.0698 14.9272 10.1678 14.9762 10.2938L15.1332 10.6928C15.2942 11.1028 15.8722 11.1028 16.0332 10.6928L16.1902 10.2928C16.2142 10.231 16.2507 10.1748 16.2976 10.1278C16.3444 10.0808 16.4004 10.044 16.4622 10.0198L16.8602 9.8628C16.9505 9.82681 17.028 9.76455 17.0826 9.68405C17.1371 9.60356 17.1663 9.50855 17.1663 9.4113C17.1663 9.31405 17.1371 9.21903 17.0826 9.13854C17.028 9.05805 16.9505 8.99579 16.8602 8.9598L16.4622 8.8018C16.4004 8.77756 16.3444 8.74078 16.2976 8.69379C16.2507 8.64681 16.2142 8.59063 16.1902 8.5288L16.0332 8.1298Z" fill="url(#paint1_radial_2449_3616)" />
      <defs>
        <radialGradient id="paint0_radial_2449_3616" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(12 0.39347) rotate(90) scale(29.3747 30.4356)">
          <stop stop-color="#2DD4BF" />
          <stop offset="0.509615" stop-color="#0EA5E9" />
          <stop offset="1" stop-color="#D946EF" />
        </radialGradient>
        <radialGradient id="paint1_radial_2449_3616" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(15.5832 7.57637) rotate(90) scale(4.49886 4.48227)">
          <stop stop-color="#2DD4BF" />
          <stop offset="0.509615" stop-color="#0EA5E9" />
          <stop offset="1" stop-color="#D946EF" />
        </radialGradient>
      </defs>
    </svg>
  )
}

const SystemCol: React.ComponentType = () => {
  return (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" className='group-hover:block hidden'>
      <path opacity="0.5" d="M9.5 2H14.5C17.328 2 18.743 2 19.621 2.879C20.5 3.757 20.5 5.172 20.5 8V15H16.667C15.9097 15 15.1728 15.2456 14.567 15.7L13.633 16.4C13.5465 16.4649 13.4412 16.5 13.333 16.5H10.667C10.5588 16.5 10.4535 16.4649 10.367 16.4L9.433 15.7C8.82716 15.2456 8.0903 15 7.333 15H3.5V8C3.5 5.172 3.5 3.757 4.379 2.879C5.257 2 6.672 2 9.5 2Z" fill="url(#paint0_radial_2500_7438)" />
      <path d="M5 22H19C19.7956 22 20.5587 21.6839 21.1213 21.1213C21.6839 20.5587 22 19.7956 22 19V17.5C22 17.2348 21.8946 16.9804 21.7071 16.7929C21.5196 16.6054 21.2652 16.5 21 16.5H16.667C16.2343 16.5 15.8132 16.6404 15.467 16.9L14.533 17.6C14.1868 17.8596 13.7657 18 13.333 18H10.667C10.2343 18 9.81319 17.8596 9.467 17.6L8.533 16.9C8.18681 16.6404 7.76574 16.5 7.333 16.5H3C2.73478 16.5 2.48043 16.6054 2.29289 16.7929C2.10536 16.9804 2 17.2348 2 17.5V19C2 19.7956 2.31607 20.5587 2.87868 21.1213C3.44129 21.6839 4.20435 22 5 22Z" fill="url(#paint1_radial_2500_7438)" />
      <defs>
        <radialGradient id="paint0_radial_2500_7438" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(12 0.878076) rotate(90) scale(20.5264 24.0654)">
          <stop stop-color="#2DD4BF" />
          <stop offset="0.509615" stop-color="#0EA5E9" />
          <stop offset="1" stop-color="#D946EF" />
        </radialGradient>
        <radialGradient id="paint1_radial_2500_7438" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(12 16.0744) rotate(90) scale(7.78586 28.3122)">
          <stop stop-color="#2DD4BF" />
          <stop offset="0.509615" stop-color="#0EA5E9" />
          <stop offset="1" stop-color="#D946EF" />
        </radialGradient>
      </defs>
    </svg>


  )
}

interface AppMode {
  code: string;
  name: string;
  icon: React.ComponentType;
  coloredIcon: React.ComponentType;
}

const appModes: AppMode[] = [
  {
    code: 'light',
    name: 'Light',
    icon: GrSun,
    coloredIcon: SunCol
  },
  {
    code: 'dark',
    name: 'Dark',
    icon: GrMoon,
    coloredIcon: MoonCol
  },
  {
    code: 'system',
    name: 'System',
    icon: TrSystem,
    coloredIcon: SystemCol
  }
];

export default function AppModePopup({ isOpen, onClose, onAppModeChange, currentAppMode = 'system' }: AppModePopupProps) {
  const [selectedAppMode, setSelectedAppMode] = useState(currentAppMode);

  const handleAppModeSelect = (appModeCode: string) => {
    setSelectedAppMode(appModeCode);
    onAppModeChange(appModeCode);
    onClose();
  };

  if (!isOpen) return null;

  return (
    <>
      {/* Backdrop */}
      <div
        className="fixed inset-0 bg-transparent z-40"
        onClick={onClose}
      />

      {/* Popup */}
      <div className="fixed top-[54px] right-[48px] z-50">
        <div className="bg-white border border-slate-300 rounded-3xl p-[14px] shadow-lg min-w-[180px]">
          <div className="flex flex-col gap-[2px]">
            {appModes.map((appMode) => (
              <button
                key={appMode.code}
                onClick={() => handleAppModeSelect(appMode.code)}
                className={`group flex items-center gap-[10px] px-[8px] py-[4px] rounded-lg transition-all duration-200 hover:bg-slate-50 ${selectedAppMode === appMode.code ? 'bg-slate-200' : ''
                  }`}
              >
                {/* Theme Mode Icon */}
                <div className="w-6 h-6 flex items-center justify-center relative">
                  {/* Default Icon */}
                  <div className="opacity-100 group-hover:opacity-0 transition-opacity duration-200">
                    <appMode.icon />
                  </div>
                  {/* Colored Icon */}
                  <div className="absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200">
                    <appMode.coloredIcon />
                  </div>
                </div>

                {/* Mode name */}
                <span className="text-sm font-normal text-slate-700 leading-5">
                  {appMode.name}
                </span>
              </button>
            ))}
          </div>
        </div>
      </div>
    </>
  );
}
